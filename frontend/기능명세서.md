# UniBar 프론트엔드 기능 명세서

## 1. 개요
UniBar는 레스토랑/카페 운영을 위한 관리 시스템입니다. 홀 관리, 주방 관리, 대시보드, 설정 등의 기능을 제공합니다.

## 2. 인증 및 사용자 관리

### 2.1 로그인
- **기능**: 사용자 인증을 통한 시스템 접근
- **구현 위치**: `src/pages/Login.tsx`
- **주요 기능**:
  - 아이디/비밀번호 입력
  - 로그인 버튼 클릭 시 대시보드로 이동 (현재는 테스트 모드로 무조건 성공 처리)
  - 로딩 상태 표시
  - 에러 메시지 표시
  - API 연동 준비됨 (`src/api/client.ts`의 `login` 함수)
- **상태 관리**: localStorage에 토큰 저장

### 2.2 회원가입
- **기능**: 신규 사용자 등록
- **구현 위치**: `src/components/SignupModal.tsx`
- **주요 기능**:
  - 이름, 전화번호, 아이디, 비밀번호, 비밀번호 확인 입력
  - 폼 유효성 검사
  - API 연동 준비됨 (현재는 콘솔 로그만 출력)

### 2.3 비밀번호 재설정
- **기능**: 기존 사용자의 비밀번호 변경
- **구현 위치**: `src/components/ResetPasswordModal.tsx`
- **주요 기능**:
  - 아이디, 현재 비밀번호, 변경 비밀번호, 변경 비밀번호 확인 입력
  - 폼 유효성 검사
  - API 연동 준비됨 (현재는 콘솔 로그만 출력)

### 2.4 로그아웃
- **기능**: 세션 종료 및 로그인 페이지로 이동
- **구현 위치**: 모든 페이지의 헤더에 Logout 버튼
- **주요 기능**:
  - localStorage에서 토큰 제거
  - 로그인 페이지로 리다이렉트

## 3. 대시보드

### 3.1 대시보드 메인
- **기능**: 전체 운영 현황 조회
- **구현 위치**: `src/pages/Dashboard.tsx`
- **주요 기능**:
  - **기간별 필터링**: 어제, 오늘, 이번주 선택
  - **통계 카드**:
    - 총 매출: 선택한 기간의 총 매출액 표시 (원 단위, 천단위 콤마)
    - 예약 건: 예약 건수 표시 (현재는 하드코딩된 "000건")
    - 음식 주문 건: 선택한 기간의 주문 건수 표시
  - **시간대별 매출 차트**: 차트 영역 (현재는 플레이스홀더)
  - **날짜 표시**: 현재 날짜를 "YYYY.MM.DD (요일)" 형식으로 표시
  - **실시간 업데이트**: localStorage 변경 시 자동 반영 (500ms 간격 체크)

### 3.2 통계 계산 로직
- **데이터 소스**: localStorage의 `allOrders` 배열
- **필터링 기준**:
  - `orderDate` 필드가 있으면 날짜로 필터링
  - 없으면 `id`(타임스탬프)로 날짜 판단
- **기간 계산**:
  - 어제: 전날 00:00:00 ~ 23:59:59
  - 오늘: 오늘 00:00:00 ~ 23:59:59
  - 이번주: 월요일 00:00:00 ~ 일요일 23:59:59

## 4. 홀 관리

### 4.1 예약 관리
- **기능**: 고객 예약 등록 및 관리
- **구현 위치**: `src/pages/Reservation.tsx`
- **주요 기능**:
  - **예약 목록 조회**: 테이블 형식으로 예약 정보 표시
    - 예약자명, 인원수, 예약일 표시
  - **예약 등록**: `ReservationCreateModal`을 통한 신규 예약 등록
    - 예약자명, 인원수, 예약일 입력
  - **예약 수정**: `ReservationEditModal`을 통한 예약 정보 수정
  - **예약 완료**: `ReservationCompleteModal`을 통한 예약 완료 처리 및 목록에서 제거
  - **데이터 형식**: 날짜는 "YYYY-MM-DD" 형식으로 저장, 표시는 "YYYY.MM.DD" 형식

### 4.2 주문 관리

#### 4.2.1 주문 목록
- **기능**: 테이블별 주문 현황 조회
- **구현 위치**: `src/pages/OrderList.tsx`
- **주요 기능**:
  - **테이블 그리드**: 설정된 테이블 수만큼 카드 형식으로 표시
  - **주문 내역 표시**: 각 테이블의 현재 주문 내역 표시
    - 같은 메뉴는 수량 합산하여 표시 (예: "김치찌개 x3")
    - 주문 없음 상태 표시
  - **테이블 클릭**: 테이블 상세 페이지로 이동
  - **실시간 업데이트**: localStorage 변경 시 자동 반영 (300ms 간격 체크)
  - **데이터 소스**:
    - `tableOrders_{tableId}`: 아직 결제되지 않은 주문
    - `tableCompletedOrders_{tableId}`: 결제 완료된 주문 (테이블 종료 전까지)

#### 4.2.2 주문 상세
- **기능**: 특정 테이블의 주문 처리
- **구현 위치**: `src/pages/OrderDetail.tsx`
- **주요 기능**:
  - **메뉴 선택**: 메뉴 카드 클릭 시 주문 내역에 추가
    - 같은 메뉴 클릭 시 수량 증가
    - 메뉴가 없으면 Setting 페이지에서 등록하라는 메시지 표시
  - **주문 내역 관리**:
    - 주문 내역 목록 표시
    - 수량 조절 (+/- 버튼)
    - 수량 0이 되면 자동 삭제
  - **주문하기**: 결제 모달 열기
    - 주문 내역이 없으면 알림 표시
    - 총 금액 표시 (천단위 콤마)
  - **결제 처리**: `PaymentModal`을 통한 결제
    - QR 코드 이미지 표시 (localStorage에서 불러옴)
    - 결제 완료 확인 팝업
    - 결제 완료 시:
      - 전체 주문 내역(`allOrders`)에 추가
      - 총 매출 업데이트
      - 주문 건수 업데이트
      - 테이블별 완료 주문에 추가
      - 테이블 주문 내역 초기화
  - **테이블 종료**: 테이블 종료 확인 팝업
    - 테이블 주문 내역 및 완료 주문 내역 모두 초기화

### 4.3 결제 모달
- **기능**: 주문 결제 처리
- **구현 위치**: `src/components/PaymentModal.tsx`
- **주요 기능**:
  - **QR 코드 표시**: localStorage에서 QR 코드 이미지 불러와 표시
    - QR 코드가 없으면 샘플 QR 코드 표시
  - **결제 완료 확인**: 결제 금액 확인 팝업
    - 취소/확인 버튼
  - **실시간 업데이트**: QR 코드 변경 시 자동 반영 (500ms 간격 체크)

## 5. 주방 관리

### 5.1 잔여 주문 내역
- **기능**: 조리 완료되지 않은 주문 조회 및 완료 처리
- **구현 위치**: `src/pages/RemainingOrders.tsx`
- **주요 기능**:
  - **주문 목록**: 카드 형식으로 주문 정보 표시
    - 테이블명, 주문 시간, 주문 내역 (메뉴명 x 수량)
  - **조리 완료 처리**: 각 주문의 "조리 완료" 버튼 클릭
    - 확인 팝업 표시 (주문 내역 포함)
    - 확인 시 `completedOrderIds`에 주문 ID 추가
    - 목록에서 제거
  - **필터링**: `allOrders`에서 `completedOrderIds`에 없는 주문만 표시
  - **실시간 업데이트**: localStorage 변경 시 자동 반영 (500ms 간격 체크)

### 5.2 전체 주문 내역
- **기능**: 모든 주문 내역 조회
- **구현 위치**: `src/pages/AllOrders.tsx`
- **주요 기능**:
  - **주문 목록**: 테이블 형식으로 모든 주문 표시
    - 테이블명, 주문 내역 (메뉴명 x 수량), 주문 시간
  - **데이터 소스**: localStorage의 `allOrders` 배열
  - **실시간 업데이트**: localStorage 변경 시 자동 반영 (500ms 간격 체크)

## 6. 설정

### 6.1 설정 메인
- **기능**: 시스템 설정 관리
- **구현 위치**: `src/pages/Setting.tsx`
- **탭 구조**: 테이블 수, 메뉴, QR 코드

### 6.2 테이블 수 설정
- **기능**: 레스토랑 테이블 수량 관리
- **주요 기능**:
  - **테이블 수 조절**: +/- 버튼으로 수량 변경 (최소 1개)
  - **저장**: 저장 버튼 클릭 시 확인 팝업
    - 확인 시 localStorage에 저장
    - 모든 페이지에서 실시간 반영
  - **기본값**: 8개

### 6.3 메뉴 관리
- **기능**: 레스토랑 메뉴 등록 및 관리
- **주요 기능**:
  - **메뉴 등록**:
    - 메뉴명, 금액 입력
    - 금액은 천단위 콤마 자동 포맷팅
    - Enter 키로 등록 가능
    - 유효성 검사 (메뉴명, 금액 필수, 금액은 양수)
  - **메뉴 목록**: 테이블 형식으로 표시
    - NO, 메뉴명, 금액, 설정 (삭제/수정 버튼)
  - **메뉴 수정**: 수정 버튼 클릭 시 모달 열기
    - 메뉴명, 금액 수정
    - 확인 시 업데이트
  - **메뉴 삭제**: 삭제 버튼 클릭 시 확인 후 삭제
  - **데이터 저장**: localStorage의 `menus` 배열에 저장

### 6.4 QR 코드 관리
- **기능**: 결제용 QR 코드 이미지 등록
- **주요 기능**:
  - **QR 코드 등록**: 파일 선택 버튼 클릭
    - 이미지 파일만 업로드 가능
    - 파일 크기 제한: 5MB
    - Base64 형식으로 localStorage에 저장
  - **QR 코드 미리보기**: 등록된 QR 코드 이미지 표시
    - QR 코드가 없으면 샘플 QR 코드 표시
  - **데이터 저장**: localStorage의 `qrCodeImage`에 Base64 문자열로 저장

## 7. 공통 컴포넌트

### 7.1 사이드바
- **기능**: 네비게이션 메뉴
- **구현 위치**: `src/components/Sidebar.tsx`
- **주요 기능**:
  - **로고**: 클릭 시 대시보드로 이동
  - **홀 메뉴** (아코디언):
    - 예약: `/reservation`로 이동
    - 주문: `/order`로 이동
  - **주방 메뉴** (아코디언):
    - 잔여 주문 내역: `/remaining-orders`로 이동
    - 전체 주문 내역: `/all-orders`로 이동
  - **Setting**: `/setting`로 이동
  - **활성 상태 표시**: 현재 페이지에 따라 메뉴 항목 하이라이트
  - **자동 확장**: 현재 페이지에 따라 해당 메뉴 그룹 자동 확장

### 7.2 공통 헤더
- **기능**: 모든 페이지 상단에 표시되는 헤더
- **주요 기능**:
  - **날짜 표시**: 현재 날짜 "YYYY.MM.DD (요일)" 형식
  - **인사말**: "000님 안녕하세요 :)" (하드코딩)
  - **로그아웃 버튼**: 클릭 시 로그아웃 처리

## 8. 데이터 구조

### 8.1 localStorage 키 목록
- `token`: 인증 토큰
- `tableCount`: 테이블 수량
- `menus`: 메뉴 배열
- `qrCodeImage`: QR 코드 이미지 (Base64)
- `allOrders`: 전체 주문 내역 배열
- `totalSales`: 총 매출 (문자열)
- `totalOrderCount`: 총 주문 건수 (문자열)
- `tableOrders_{tableId}`: 테이블별 미결제 주문 배열
- `tableCompletedOrders_{tableId}`: 테이블별 완료 주문 배열
- `completedOrderIds`: 조리 완료된 주문 ID 배열

### 8.2 데이터 모델

#### Order (주문)
```typescript
{
  id: number,              // 타임스탬프 기반 ID
  tableId: number,        // 테이블 번호
  tableName: string,      // 테이블명 (예: "1번 테이블")
  items: OrderItem[],     // 주문 항목 배열
  orderTime: string,      // 주문 시간 (HH:MM 형식)
  orderDate?: string,     // 주문 날짜 (YYYY-MM-DD 형식, 선택적)
  totalPrice: number      // 총 금액
}
```

#### OrderItem (주문 항목)
```typescript
{
  id: number,             // 메뉴 ID
  name: string,           // 메뉴명
  quantity: number        // 수량
}
```

#### Menu (메뉴)
```typescript
{
  id: number,             // 메뉴 ID (타임스탬프 기반)
  name: string,          // 메뉴명
  price: number          // 가격
}
```

#### Reservation (예약)
```typescript
{
  id: number,             // 예약 ID (타임스탬프 기반)
  name: string,          // 예약자명
  people: number,        // 인원수
  date: string           // 예약일 (YYYY-MM-DD 형식)
}
```

## 9. 라우팅

### 9.1 라우트 구성
- `/`: 로그인 페이지
- `/dashboard`: 대시보드
- `/reservation`: 예약 관리
- `/order`: 주문 목록
- `/order/:tableId`: 주문 상세
- `/remaining-orders`: 잔여 주문 내역
- `/all-orders`: 전체 주문 내역
- `/setting`: 설정
- `*`: 404 처리 (로그인 페이지로 리다이렉트)

## 10. API 연동 준비

### 10.1 API 클라이언트
- **구현 위치**: `src/api/client.ts`
- **기본 URL**: `http://localhost:8080/api` (환경 변수로 설정 가능)
- **구현된 API**:
  - `login`: 로그인 API (POST `/auth/login`)
  - `logout`: 로그아웃 API (POST `/auth/logout`)

### 10.2 미구현 API (TODO)
- 회원가입 API
- 비밀번호 재설정 API
- 주문 관련 API
- 예약 관련 API
- 메뉴 관리 API
- 테이블 설정 API
- QR 코드 업로드 API
- 통계 조회 API

## 11. 기술 스택

- **프레임워크**: React 18
- **언어**: TypeScript
- **라우팅**: React Router v6
- **빌드 도구**: Vite
- **상태 관리**: React Hooks (useState, useEffect)
- **데이터 저장**: localStorage (현재는 클라이언트 사이드만)

## 12. 주요 특징

### 12.1 실시간 동기화
- localStorage 변경 감지를 통한 실시간 업데이트
- `storage` 이벤트 리스너 + interval 체크 (500ms 간격)
- 여러 탭 간 데이터 동기화 지원

### 12.2 사용자 경험
- 로딩 상태 표시
- 에러 메시지 표시
- 확인 팝업을 통한 안전한 작업 처리
- 천단위 콤마 포맷팅
- 날짜 형식 통일

### 12.3 데이터 관리
- 클라이언트 사이드 데이터 저장 (localStorage)
- 타임스탬프 기반 ID 생성
- 날짜 기반 필터링 지원

## 13. 향후 개선 사항

1. **백엔드 API 연동**: 모든 기능의 실제 API 연동
2. **인증 보안 강화**: 토큰 갱신, 자동 로그아웃 등
3. **차트 구현**: 시간대별 매출 차트 라이브러리 연동
4. **예약 건수 통계**: 실제 예약 데이터 기반 통계
5. **사용자 정보**: 실제 사용자 정보 표시
6. **에러 처리**: 전역 에러 핸들링
7. **로딩 최적화**: 불필요한 리렌더링 최소화
8. **반응형 디자인**: 모바일 지원
9. **접근성**: 키보드 네비게이션, 스크린 리더 지원
10. **테스트**: 단위 테스트, 통합 테스트 추가

